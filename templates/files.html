{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
  <div class="container center">
    <div class="calculationdiv" style="display: block;">
    <form action="{% url 'calculate' order.id %}" method="post" class="form details center" id="form1"  enctype="multipart/form-data">
      <table class="{{action}}">
        <thead>
          <tr>
            <th>PDF Name</th>
            <th>Preview Link</th>
            <th>Type of Print</th>
            <th>No. of Copies</th>
          </tr>
        </thead>
        <tbody>
          
        {% for document in files %}
            <tr>
              <td contenteditable="true">{{ document.name }}
                <input type="hidden" name="pdf_name" value="{{ document.name }}">
              </td>
              <td><a href="{{document.file.url}}">Preview File</a></td>
              <td>
                <select name="type" id="type">
                  <option value="Single Side">Single Side</option>
                  <option value="Two pages">Two Side</option>
                </select>
              </td>
              <td><input type="number" name="copies" id="copies" min="1" max="100" value="{{document.copies}}"></td>
            </tr>
        {% endfor %}
        </tbody>
      </table>
      {% csrf_token %}
      <div class="input center">
        <button type="submit" id="btn" class="{{ show }}">Next</button>
        <button type="submit" id="rzp-button1" class="{{display}}">Pay {{price}}/-</button>
      </div>
      
    </form>
    </div>
  </div>


  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <script>
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
          const cookies = document.cookie.split(';');
          for (let i = 0; i < cookies.length; i++) {
              const cookie = cookies[i].trim();
              if (cookie.substring(0, name.length + 1) === (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
  }
    var options = {
        "key": "rzp_test_qyDzuiKyrhzxy2", // Enter the Key ID generated from the Dashboard
        "amount": "{{payment.amount}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
        "currency": "INR",
        "name": "Xerox Shop",
        "description": "Get the shit done",
        "order_id": "{{payment.id}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
        "callback_url": "{% url 'payment_verification' order.id %}",
        "prefill": {
            "name": "Kaun hei re thu",
            "email": "gaurav.kumar@example.com",
            "contact": "9000090000"
        },
        "notes": {
            "address": "Razorpay Corporate Office"
        },
        "theme": {
            "color": "#3399cc"
        }
    };
    var rzp1 = new Razorpay(options);
    document.getElementById('rzp-button1').onclick = function(e){
        rzp1.open();
        e.preventDefault();
    }
    </script>
</body>
</html>